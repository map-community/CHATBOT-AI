# ============================================================
# RAG Chatbot ML/AI Configuration
# ============================================================
# 이 파일은 ML/AI 관련 하이퍼파라미터를 관리합니다.
# 실험 추적, A/B 테스트, 환경별 설정 관리에 사용됩니다.
#
# 수정 이력:
# - 2025-11-25: 초기 생성 (하드코딩 제거)
# ============================================================

# ============================================================
# 텍스트 처리 (Text Processing)
# ============================================================
text_processing:
  # 청크 크기 (Chunk Size)
  # - 긴 텍스트를 몇 글자 단위로 분할할지 결정
  # - 너무 작으면: 문맥 손실, 너무 크면: 검색 정확도 저하
  # - 권장: 500-1000 (한국어 기준)
  chunk_size: 850

  # 청크 겹침 (Chunk Overlap)
  # - 이전 청크와 다음 청크가 몇 글자씩 겹치게 할지
  # - 문장이 중간에 잘리는 것을 방지
  # - 권장: chunk_size의 10-15%
  chunk_overlap: 100

# ============================================================
# BM25 검색 알고리즘 (Sparse Retrieval)
# ============================================================
bm25:
  # k1 파라미터 (Term Frequency Saturation)
  # - 단어 빈도가 점수에 미치는 영향 조절
  # - 값이 클수록: 단어 빈도가 높을수록 점수 증가
  # - 값이 작을수록: 빈도 증가에 따른 점수 증가 완만
  # - 권장: 1.2 ~ 2.0 (기본값: 1.5)
  k1: 1.5

  # b 파라미터 (Document Length Normalization)
  # - 문서 길이 정규화 정도
  # - 0: 정규화 안 함, 1: 완전 정규화
  # - 권장: 0.75 (표준값)
  b: 0.75

# ============================================================
# Dense Retrieval (의미 기반 검색)
# ============================================================
dense_retrieval:
  # 유사도 스케일 팩터
  # - Pinecone 코사인 유사도를 조정하는 스케일
  # - Pinecone 유사도 범위: -1 ~ 1 → 스케일 적용 후 점수화
  # - 실험적으로 결정된 값
  similarity_scale: 3.26

  # 명사 매칭 가중치
  # - 쿼리의 명사가 문서 제목에 포함될 때 추가 점수
  # - 값이 클수록: 키워드 매칭 중요도 증가
  # - 권장: 0.1 ~ 0.3
  noun_weight: 0.20

  # 숫자 포함 명사 가중치
  # - 숫자가 포함된 명사 매칭 시 추가 점수
  # - 예: "2024년", "1학기", "3차" 등
  # - 숫자는 보통 중요한 정보이므로 가중치 높임
  # - 권장: 0.2 ~ 0.3
  digit_weight: 0.24

# ============================================================
# 문서 클러스터링 (Document Clustering)
# ============================================================
clustering:
  # 유사도 임계값 (Similarity Threshold)
  # - 두 문서를 같은 클러스터로 묶을 최소 유사도
  # - 값이 높을수록: 더 유사한 문서만 묶임 (클러스터 수 증가)
  # - 값이 낮을수록: 느슨하게 묶임 (클러스터 수 감소)
  # - 권장: 0.85 ~ 0.95
  similarity_threshold: 0.89

# ============================================================
# ZIP 파일 처리 (보안 제한)
# ============================================================
zip_processing:
  # 최대 ZIP 파일 크기 (bytes)
  # - 100MB = 100 * 1024 * 1024
  # - DoS 공격 방지용
  max_zip_size: 104857600  # 100MB

  # ZIP 내 최대 파일 개수
  # - 너무 많은 파일 처리 방지
  max_total_files: 50

  # 압축 해제 후 최대 크기 (bytes)
  # - 500MB = 500 * 1024 * 1024
  # - Zip Bomb 방어용
  max_extraction_size: 524288000  # 500MB

# ============================================================
# 실험 추적 (Experiment Tracking)
# ============================================================
# 아래는 과거 실험 기록입니다. 참고용으로 보관합니다.
experiments:
  baseline:
    date: "2025-11-25"
    description: "초기 설정값 (하드코딩 제거 전)"
    text_processing:
      chunk_size: 850
      chunk_overlap: 100
    bm25:
      k1: 1.5
      b: 0.75
    dense_retrieval:
      similarity_scale: 3.26
      noun_weight: 0.20
      digit_weight: 0.24
    clustering:
      similarity_threshold: 0.89
    # 성능 메트릭은 추후 추가
    # metrics:
    #   precision_at_5: 0.87
    #   recall_at_5: 0.82
    #   mrr: 0.79

# ============================================================
# 환경별 설정 (Environment-specific)
# ============================================================
# 개발/프로덕션 환경에서 다른 값을 사용하려면 아래 주석 해제
# environments:
#   development:
#     text_processing:
#       chunk_size: 500  # 개발 시 더 작은 청크로 빠른 테스트
#   production:
#     text_processing:
#       chunk_size: 850  # 프로덕션은 최적화된 값 사용
